<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Friend Finder Survey</title>

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

  <style>
    .btn-primary {
      background-color: #337ab7;
      border-color: #2e6da4;
    }

    h2 {
      line-height: 150%;
    }

    #submit,
    h3 {
      margin-top: 20px;
    }
  </style>

</head>

<body>

  <div class="container">
    <h2>Survey Questions</h2>
    <hr>
    <h2>About you</h2>
    <form role="form">
      <div class="form-group">
        <label for="friend-name">Name (Required)</label>
        <input type="text" class="form-control" id="name">
      </div>
      <div class="form-group">
        <label for="saved-image">Link to photo image (Required)</label>
        <input type="text" class="form-control" id="photo">
      </div>


      <h3>Question 1</h3>
      <h4>You are a huge cinefile. Subtitles do not intimidate you!</h4>
      <select id="q1">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 2</h3>
      <h4>Dogs are great. Yorkies are the best dogs ever.</h4>
      <select id="q2">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 3</h3>
      <h4>Kurt Russell is super amazing.</h4>
      <select id="q3">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 4</h3>
      <h4>Tacos are underrated. We should start a revolution!</h4>
      <select id="q4">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 5</h3>
      <h4>Bigfoot, the hide-and-seek Champion of the world, is out there somewhere.</h4>
      <select id="q5">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>


      <h3>Question 6</h3>
      <h4>Not only can you pronounce Nikolai Khabibulin, you know what teams he played for.</h4>
      <select id="q6">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 7</h3>
      <h4>Halloween is the best holiday. Second only to your birthday.</h4>
      <select id="q7">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>


      <h3>Question 8</h3>
      <h4>You can, with complete certainty, say that disco is dead.</h4>
      <select id="q8">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>


      <h3>Question 9</h3>
      <h4>Shark Week is the only week worth mentioning.</h4>
      <select id="q9">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <h3>Question 10</h3>
      <h4>Should a Tardis appear suddenly and without warning, you would 100% ask to be invited in.</h4>
      <select id="q10">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

      <button type="button" class="btn btn-primary btn-lg btn-block" id="submit" data-toggle="modal"
        data-target="#exampleModal"><i class="fa fa-check-circle" aria-hidden="true"></i>
        Submit
      </button>

  </div>

  <footer class="footer">
    <div class="container">
      <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/rachaelbelle/Friend-Finder"
          target="_blank">Github Repo</a>
    </div>
  </footer>


  <!-- id="exampleModal" -->

  <div id="exampleModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">

      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Best Match</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" style="position: fixed; width: 400px; height: 400px;  z-index: -9999;"></div>
          <h2 id="match-name"></h2>
          <img id="match-img" src="#" alt="">

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</body>

</html>

<!-- BELOW CODE IS CRITICAL. IT HANDLES HOW FORM DATA IS SENT TO OUR SERVER -->

<script type="text/javascript">

  $("#submit").on("click", function (event) {
    event.preventDefault();
    // console.log("I am the CONSOLE!")

    function validateForm() {
      var isValid = true;
      $(".form-control").each(function () {
        if ($(this).val() === "") {
          isValid = false;
        }
      });

      $("select").each(function () {

        if ($(this).val() === "") {
          isValid = false;
        }
      });
      return isValid;
    }

    if (validateForm()) {
      // Here we grab the form elements

      var newFriend = {
        name: $("#name").val().trim(),
        photo: $("#photo").val().trim(),
        scores: [
          $("#q1").val().trim(),
          $("#q2").val().trim(),
          $("#q3").val().trim(),
          $("#q4").val().trim(),
          $("#q5").val().trim(),
          $("#q6").val().trim(),
          $("#q7").val().trim(),
          $("#q8").val().trim(),
          $("#q9").val().trim(),
          $("#q10").val().trim()
        ]
      };
      // console.log("info in: " + newFriend)

      $.post("/api/friends", newFriend, function (data) {

        $("#match-name").text(data.name);
        $("#match-img").attr("src", data.photo);

        console.log("photo" + data.photo)

        $("#exampleModal").modal("toggle");
        console.log("this is what " +  JSON.stringify($("#exampleModal").modal("toggle")))

        // console.log("this is the" + data.name)

      });
    } else {
      alert("Please fill out all fields before submitting!");
    };

    console.log("page is loaded")

  });

</script>
